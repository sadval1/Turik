<!DOCTYPE html>
<html lang="ru">
<head>
  <!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-firestore-compat.js"></script>
  <meta charset="UTF-8" />
  <title>Турнирная таблица</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; }
    input { margin: 5px; padding: 5px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #aaa; padding: 8px; text-align: center; }
    th { background-color: #eee; }
  </style>
</head>
<body>
  <h1>Турнир: Ввод результатов</h1>
  <form id="matchForm">
    <input type="text" id="player1" placeholder="Игрок 1" required />
    <input type="number" id="score1" placeholder="Счет 1" required />
    <input type="text" id="player2" placeholder="Игрок 2" required />
    <input type="number" id="score2" placeholder="Счет 2" required />
    <button type="submit">Добавить матч</button>
  </form>

  <h2>Турнирная таблица</h2>
  <table id="standings">
    <thead>
      <tr>
        <th>Игрок</th>
        <th>Игры</th>
        <th>Очки</th>
        <th>Победы</th>
        <th>Ничьи</th>
        <th>Поражения</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    let matches = JSON.parse(localStorage.getItem("matches")) || [];

    document.getElementById("matchForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const player1 = document.getElementById("player1").value.trim();
      const player2 = document.getElementById("player2").value.trim();
      const score1 = parseInt(document.getElementById("score1").value);
      const score2 = parseInt(document.getElementById("score2").value);

      if (!player1 || !player2 || isNaN(score1) || isNaN(score2)) return;

      matches.push({ player1, player2, score1, score2 });
      localStorage.setItem("matches", JSON.stringify(matches));

      this.reset();
      updateTable();
    });

    function updateTable() {
      const table = {};
      matches.forEach(({ player1, player2, score1, score2 }) => {
        [player1, player2].forEach(p => {
          if (!table[p]) table[p] = { games: 0, points: 0, wins: 0, draws: 0, losses: 0 };
        });

        table[player1].games += 1;
        table[player2].games += 1;

        if (score1 > score2) {
          table[player1].points += 3;
          table[player1].wins += 1;
          table[player2].losses += 1;
        } else if (score2 > score1) {
          table[player2].points += 3;
          table[player2].wins += 1;
          table[player1].losses += 1;
        } else {
          table[player1].points += 1;
          table[player2].points += 1;
          table[player1].draws += 1;
          table[player2].draws += 1;
        }
      });

      const tbody = document.querySelector("#standings tbody");
      tbody.innerHTML = "";

      Object.entries(table)
        .sort((a, b) => b[1].points - a[1].points)
        .forEach(([player, stats]) => {
          const row = `<tr>
            <td>${player}</td>
            <td>${stats.games}</td>
            <td>${stats.points}</td>
            <td>${stats.wins}</td>
            <td>${stats.draws}</td>
            <td>${stats.losses}</td>
          </tr>`;
          tbody.insertAdjacentHTML("beforeend", row);
        });
    }

    updateTable();
  </script>
</body>
</html>
